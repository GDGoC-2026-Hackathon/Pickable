openapi: 3.0.3
info:
  title: Pickable API
  description: 회원가입·인증·채용공고 API 명세 (NextAuth 세션 쿠키 인증)
  version: 0.5.0

servers:
  - url: /
    description: 상대 경로 (프론트와 동일 오리진)

tags:
  - name: Health
    description: 서버 상태
  - name: Auth
    description: 인증·현재 사용자
  - name: Signup
    description: 역할 선택 및 회원가입
  - name: JobPostings
    description: 채용 공고 열람 (취준생·비로그인용 — 목록 조회 · 상세 조회)
  - name: CorporationJobPostings
    description: 기업 전용 공고 관리 (자사 공고 목록 · 생성 · 수정 · 삭제)
  - name: BrandingCard
    description: AI 브랜딩 카드 (생성 · 조회 · 수정 · 삭제 · 필드 재생성)

paths:
  # ──────────────────────────────────────
  # Health
  # ──────────────────────────────────────

  /api/health:
    get:
      tags: [Health]
      summary: 헬스 체크
      responses:
        "200":
          description: 정상
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: string, example: ok }
                  timestamp: { type: string, format: date-time }

  # ──────────────────────────────────────
  # Auth
  # ──────────────────────────────────────

  /api/auth/me:
    get:
      tags: [Auth]
      summary: 현재 로그인 사용자
      security: [sessionCookie: []]
      responses:
        "200":
          description: 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id: { type: string }
                      name: { type: string, nullable: true }
                      email: { type: string, nullable: true }
                      image: { type: string, nullable: true }
        "401":
          $ref: "#/components/responses/Unauthorized"

  # ──────────────────────────────────────
  # Signup
  # ──────────────────────────────────────

  /api/signup/status:
    get:
      tags: [Signup]
      summary: 가입 상태 조회
      description: 역할 선택 여부(role), 프로필/기업 등록 여부(hasProfile)
      security: [sessionCookie: []]
      responses:
        "200":
          description: 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      role:
                        type: string
                        enum: [JOB_SEEKER, CORPORATION]
                        nullable: true
                      hasProfile: { type: boolean }
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/UserNotFound"
        "500":
          $ref: "#/components/responses/DBError"

  /api/signup/role:
    post:
      tags: [Signup]
      summary: 역할 선택
      description: 로그인 후 1회만 설정 가능 (JOB_SEEKER | CORPORATION)
      security: [sessionCookie: []]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [role]
              properties:
                role:
                  type: string
                  enum: [JOB_SEEKER, CORPORATION]
      responses:
        "201":
          description: 생성됨
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id: { type: string }
                      role: { type: string, enum: [JOB_SEEKER, CORPORATION] }
        "400":
          $ref: "#/components/responses/ValidationError"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "409":
          description: 이미 역할 설정됨
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
              example:
                error: { code: ROLE_ALREADY_SET, message: "이미 역할이 설정되어 있습니다." }
        "500":
          $ref: "#/components/responses/DBError"

  /api/signup/job-seeker:
    post:
      tags: [Signup]
      summary: 취준생 프로필 등록
      description: role=JOB_SEEKER인 사용자만, 1회 등록
      security: [sessionCookie: []]
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: "#/components/schemas/JobSeekerSignup" }
      responses:
        "201":
          description: 생성됨
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id: { type: string }
                      createdAt: { type: string, format: date-time }
        "400":
          $ref: "#/components/responses/ValidationError"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "422":
          description: 역할 미선택 또는 역할 불일치
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
        "409":
          description: 이미 프로필 등록됨
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
              example:
                error: { code: PROFILE_ALREADY_EXISTS, message: "이미 프로필이 등록되어 있습니다." }
        "500":
          $ref: "#/components/responses/DBError"

  /api/signup/corporation:
    post:
      tags: [Signup]
      summary: 기업 등록
      description: role=CORPORATION인 사용자만, 1회 등록
      security: [sessionCookie: []]
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: "#/components/schemas/CorporationSignup" }
      responses:
        "201":
          description: 생성됨
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id: { type: string }
                      name: { type: string }
                      createdAt: { type: string, format: date-time }
        "400":
          $ref: "#/components/responses/ValidationError"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "422":
          description: 역할 미선택 또는 역할 불일치
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
        "409":
          description: 이미 기업 등록됨
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
              example:
                error: { code: PROFILE_ALREADY_EXISTS, message: "이미 기업이 등록되어 있습니다." }
        "500":
          $ref: "#/components/responses/DBError"

  # ──────────────────────────────────────
  # 채용 공고 열람 (취준생·비로그인용)
  # ──────────────────────────────────────

  /api/job-postings:
    get:
      tags: [JobPostings]
      summary: 공고 목록 조회
      description: |
        채용 공고 목록을 페이지네이션으로 조회합니다.
        로그인한 취준생(JOB_SEEKER)의 경우 매칭률(matchRate)이 함께 반환됩니다.
        비로그인 사용자도 조회 가능합니다.
      parameters:
        - name: page
          in: query
          schema: { type: integer, default: 1, minimum: 1 }
          description: 페이지 번호
        - name: limit
          in: query
          schema: { type: integer, default: 10, minimum: 1, maximum: 50 }
          description: 페이지당 항목 수
        - name: status
          in: query
          schema: { type: string, enum: [OPEN, CLOSED] }
          description: 채용 상태 필터
      responses:
        "200":
          description: 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items: { $ref: "#/components/schemas/JobPostingListItem" }
                  pagination:
                    $ref: "#/components/schemas/Pagination"
        "500":
          $ref: "#/components/responses/DBError"

  /api/job-postings/{id}:
    get:
      tags: [JobPostings]
      summary: 공고 상세 조회
      description: |
        특정 채용 공고의 상세 정보를 조회합니다.
        로그인한 취준생의 경우 매칭률이 함께 반환됩니다.
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string }
          description: 공고 ID
      responses:
        "200":
          description: 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  data: { $ref: "#/components/schemas/JobPostingDetail" }
        "404":
          description: 공고 없음
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
              example:
                error: { code: JOB_POSTING_NOT_FOUND, message: "채용 공고를 찾을 수 없습니다." }
        "500":
          $ref: "#/components/responses/DBError"

  # ──────────────────────────────────────
  # 기업 전용 공고 관리
  # ──────────────────────────────────────

  /api/corporation/job-postings:
    get:
      tags: [CorporationJobPostings]
      summary: 자사 공고 목록 조회
      description: |
        기업(CORPORATION) 역할의 사용자가 자사 채용 공고를 조회합니다.
        기본적으로 활성 공고(OPEN + 마감일 미경과)만 반환합니다.
        status 파라미터로 필터를 변경할 수 있습니다.
        - 미지정(기본): 활성 공고만 (OPEN + 마감 전/상시)
        - CLOSED: 마감 공고만
        - ALL: 전체
      security: [sessionCookie: []]
      parameters:
        - name: page
          in: query
          schema: { type: integer, default: 1, minimum: 1 }
          description: 페이지 번호
        - name: limit
          in: query
          schema: { type: integer, default: 10, minimum: 1, maximum: 50 }
          description: 페이지당 항목 수
        - name: status
          in: query
          schema: { type: string, enum: [OPEN, CLOSED, ALL] }
          description: "공고 필터 (미지정: 활성 공고만, CLOSED: 마감 공고, ALL: 전체)"
      responses:
        "200":
          description: 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      data:
                        type: array
                        items: { $ref: "#/components/schemas/CorporationJobPostingItem" }
                      pagination:
                        $ref: "#/components/schemas/Pagination"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          description: 기업 정보 없음
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
              example:
                error: { code: CORPORATION_NOT_FOUND, message: "기업 정보를 찾을 수 없습니다." }
        "422":
          description: 역할 미선택 또는 역할 불일치
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
        "500":
          $ref: "#/components/responses/DBError"

    post:
      tags: [CorporationJobPostings]
      summary: 공고 생성
      description: |
        기업(CORPORATION) 역할의 사용자가 새 채용 공고를 등록합니다.
        기업 등록(Corporation)이 완료된 상태여야 합니다.
      security: [sessionCookie: []]
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: "#/components/schemas/CreateJobPosting" }
      responses:
        "201":
          description: 생성됨
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id: { type: string }
                      title: { type: string }
                      status: { type: string, enum: [OPEN, CLOSED] }
                      createdAt: { type: string, format: date-time }
        "400":
          $ref: "#/components/responses/ValidationError"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          description: 기업 정보 없음
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
              example:
                error: { code: CORPORATION_NOT_FOUND, message: "기업 정보를 찾을 수 없습니다." }
        "422":
          description: 역할 미선택 또는 역할 불일치
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
        "500":
          $ref: "#/components/responses/DBError"

  /api/corporation/job-postings/{id}:
    patch:
      tags: [CorporationJobPostings]
      summary: 공고 수정
      description: |
        기업(CORPORATION) 역할의 사용자가 자사 공고를 수정합니다.
        본인 기업의 공고만 수정 가능합니다.
        모든 필드는 선택이며, 전달된 필드만 업데이트됩니다.
      security: [sessionCookie: []]
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string }
          description: 공고 ID
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: "#/components/schemas/UpdateJobPosting" }
      responses:
        "200":
          description: 수정 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id: { type: string }
                      title: { type: string }
                      status: { type: string, enum: [OPEN, CLOSED] }
                      updatedAt: { type: string, format: date-time }
        "400":
          $ref: "#/components/responses/ValidationError"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: 본인 기업의 공고가 아닌 경우
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
              example:
                error: { code: FORBIDDEN, message: "본인 기업의 공고만 접근할 수 있습니다." }
        "404":
          description: 공고 없음
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
              example:
                error: { code: JOB_POSTING_NOT_FOUND, message: "채용 공고를 찾을 수 없습니다." }
        "422":
          description: 역할 미선택 또는 역할 불일치
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
        "500":
          $ref: "#/components/responses/DBError"

    delete:
      tags: [CorporationJobPostings]
      summary: 공고 삭제
      description: |
        기업(CORPORATION) 역할의 사용자가 자사 공고를 삭제합니다.
        본인 기업의 공고만 삭제 가능합니다.
        연결된 기술 스택(JobSkill) 등은 Cascade로 함께 삭제됩니다.
      security: [sessionCookie: []]
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string }
          description: 공고 ID
      responses:
        "200":
          description: 삭제 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id: { type: string }
                      deleted: { type: boolean, example: true }
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          description: 본인 기업의 공고가 아닌 경우
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
              example:
                error: { code: FORBIDDEN, message: "본인 기업의 공고만 접근할 수 있습니다." }
        "404":
          description: 공고 없음
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
              example:
                error: { code: JOB_POSTING_NOT_FOUND, message: "채용 공고를 찾을 수 없습니다." }
        "422":
          description: 역할 미선택 또는 역할 불일치
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
        "500":
          $ref: "#/components/responses/DBError"

  # ──────────────────────────────────────
  # AI 브랜딩 카드
  # ──────────────────────────────────────

  /api/corporation/branding-card/generate:
    post:
      tags: [BrandingCard]
      summary: AI 브랜딩 카드 생성
      description: |
        기업 프로필 정보를 기반으로 Gemini AI가 브랜딩 카드 초안을 생성합니다.
        기존 카드가 있으면 덮어씁니다 (DRAFT 상태로 재설정).
        선택적으로 프롬프트를 전달하여 AI 생성 방향을 조절할 수 있습니다.
      security: [sessionCookie: []]
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                prompt:
                  type: string
                  description: "AI 생성 방향 커스텀 프롬프트 (선택)"
            example:
              prompt: "젊고 역동적인 스타트업 이미지를 강조해주세요"
      responses:
        "201":
          description: 생성됨
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: "#/components/schemas/BrandingCardGenerated"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          description: 기업 정보 없음
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
        "422":
          description: 역할 미선택 또는 역할 불일치
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
        "500":
          description: AI 생성 오류 또는 서버 오류
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
              example:
                error: { code: AI_GENERATION_ERROR, message: "AI 콘텐츠 생성 중 오류가 발생했습니다." }

  /api/corporation/branding-card:
    get:
      tags: [BrandingCard]
      summary: 브랜딩 카드 조회
      description: 현재 로그인한 기업의 브랜딩 카드를 조회합니다.
      security: [sessionCookie: []]
      responses:
        "200":
          description: 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: "#/components/schemas/BrandingCardDetail"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          description: 브랜딩 카드 없음
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
              example:
                error: { code: BRANDING_CARD_NOT_FOUND, message: "브랜딩 카드를 찾을 수 없습니다." }
        "422":
          description: 역할 미선택 또는 역할 불일치
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
        "500":
          $ref: "#/components/responses/DBError"

    put:
      tags: [BrandingCard]
      summary: 브랜딩 카드 수정 (최종 저장 및 공개)
      description: |
        브랜딩 카드의 콘텐츠를 수정합니다.
        status를 "PUBLISHED"로 변경하면 취준생에게 공개됩니다.
        모든 필드는 선택이며, 전달된 필드만 업데이트됩니다.
      security: [sessionCookie: []]
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: "#/components/schemas/UpdateBrandingCard" }
      responses:
        "200":
          description: 수정 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: "#/components/schemas/BrandingCardDetail"
        "400":
          $ref: "#/components/responses/ValidationError"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          description: 브랜딩 카드 없음
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
        "422":
          description: 역할 미선택 또는 역할 불일치
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
        "500":
          $ref: "#/components/responses/DBError"

    delete:
      tags: [BrandingCard]
      summary: 브랜딩 카드 삭제
      description: 브랜딩 카드를 삭제합니다. 연결된 키워드도 함께 삭제됩니다.
      security: [sessionCookie: []]
      responses:
        "200":
          description: 삭제 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id: { type: string }
                      deleted: { type: boolean, example: true }
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          description: 브랜딩 카드 없음
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
        "422":
          description: 역할 미선택 또는 역할 불일치
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
        "500":
          $ref: "#/components/responses/DBError"

  /api/corporation/branding-card/regenerate-field:
    post:
      tags: [BrandingCard]
      summary: 브랜딩 카드 개별 필드 AI 재생성
      description: |
        기존 브랜딩 카드의 특정 필드만 AI로 재생성합니다.
        기존 값과 다른 톤/관점으로 새로운 콘텐츠를 생성합니다.
        재생성된 값은 자동으로 DB에 반영됩니다.
      security: [sessionCookie: []]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [field]
              properties:
                field:
                  type: string
                  enum: [catchphrase, description, keywords]
                  description: "재생성할 필드명"
            example:
              field: "catchphrase"
      responses:
        "200":
          description: 재생성 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      field:
                        type: string
                        enum: [catchphrase, description, keywords]
                      value:
                        description: "재생성된 값 (catchphrase/description은 string, keywords는 string[])"
                        oneOf:
                          - type: string
                          - type: array
                            items: { type: string }
        "400":
          $ref: "#/components/responses/ValidationError"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          description: 브랜딩 카드 없음
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
        "422":
          description: 역할 미선택 또는 역할 불일치
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }
        "500":
          description: AI 생성 오류
          content:
            application/json:
              schema: { $ref: "#/components/schemas/Error" }

components:
  securitySchemes:
    sessionCookie:
      type: apiKey
      in: cookie
      name: authjs.session-token
      description: NextAuth 세션 쿠키 (로그인 후 자동 설정)

  schemas:
    Error:
      type: object
      properties:
        error:
          type: object
          properties:
            code: { type: string }
            message: { type: string }

    # ── 회원가입 스키마 ──

    JobSeekerSignup:
      type: object
      required:
        - educationLevel
        - major
        - desiredJobRole
        - militaryStatus
        - birthDate
        - gender
      properties:
        educationLevel:
          type: string
          enum: [HIGH_SCHOOL, ASSOCIATE, BACHELOR, MASTER, DOCTORATE]
        major: { type: string }
        desiredJobRole: { type: string }
        militaryStatus:
          type: string
          enum: [NOT_APPLICABLE, COMPLETED, EXEMPT, SERVING, NOT_COMPLETED]
        desiredLocation: { type: string }
        desiredSalaryRange:
          type: string
          enum: [UNDER_2400, RANGE_2400_3000, RANGE_3000_3600, RANGE_3600_4200, RANGE_4200_5000, OVER_5000]
        commuteStart: { type: string, description: "HH:mm" }
        commuteEnd: { type: string, description: "HH:mm" }
        employmentType:
          type: string
          enum: [FULL_TIME, CONTRACT, INTERN, FREELANCE]
        birthDate: { type: string, format: date, description: "YYYY-MM-DD" }
        gender:
          type: string
          enum: [MALE, FEMALE, OTHER]
        skills:
          type: array
          items: { type: string }
        experiences:
          type: array
          items:
            type: object
            required: [type, title]
            properties:
              type: { type: string, enum: [ACTIVITY, AWARD, OVERSEAS, VOLUNTEER] }
              title: { type: string }
              description: { type: string }
              isJobRelated: { type: boolean, default: false }
        credentials:
          type: array
          items:
            type: object
            required: [type, name]
            properties:
              type: { type: string, enum: [CERTIFICATE, LANGUAGE] }
              name: { type: string }
              score: { type: string }
      example:
        educationLevel: "BACHELOR"
        major: "컴퓨터공학"
        desiredJobRole: "백엔드 개발자"
        militaryStatus: "COMPLETED"
        desiredLocation: "서울특별시 강남구"
        desiredSalaryRange: "RANGE_3000_3600"
        commuteStart: "09:00"
        commuteEnd: "18:00"
        employmentType: "FULL_TIME"
        birthDate: "1999-05-15"
        gender: "MALE"
        skills: ["Python", "Django", "PostgreSQL", "Docker"]
        experiences:
          - type: "ACTIVITY"
            title: "Google Developer Student Club 리드"
            description: "대학교 GDSC 리드로 활동하며 기술 세미나 운영"
            isJobRelated: true
          - type: "AWARD"
            title: "교내 해커톤 대상"
            description: "AI 기반 취업 매칭 서비스 개발"
            isJobRelated: true
        credentials:
          - type: "CERTIFICATE"
            name: "정보처리기사"
          - type: "LANGUAGE"
            name: "TOEIC"
            score: "900"

    CorporationSignup:
      type: object
      required: [name, industry, address, companySize]
      properties:
        name:
          type: string
          description: 기업명
        industry:
          type: string
          description: 업종/산업
        address:
          type: string
          description: 주소
        companySize:
          type: string
          enum: [STARTUP, SMALL, MEDIUM, LARGE, ENTERPRISE]
          description: 기업 규모
        thumbnailUrl:
          type: string
          description: 기업 대표 이미지 URL (선택)
        description:
          type: string
          description: 기업 소개 (선택)
        welfare:
          type: string
          description: 복리후생 (선택)
        homepageUrl:
          type: string
          description: 홈페이지 URL (선택)
        phone:
          type: string
          description: 대표 연락처 (선택)
      example:
        name: "클라우드 펄스"
        industry: "SaaS"
        address: "서울특별시 강남구 테헤란로 123"
        companySize: "STARTUP"
        thumbnailUrl: "https://example.com/company-logo.png"
        description: "SaaS 전문 강소기업"
        welfare: "재택 근무, 스톡옵션, 도서 구매 지원"
        homepageUrl: "https://cloudpulse.io"
        phone: "02-1234-5678"

    # ── 채용 공고 스키마 (공통) ──

    CreateJobPosting:
      type: object
      required: [title, jobTrack, minEducationLevel, militaryPolicy, careerPolicy]
      properties:
        title:
          type: string
          description: "뽑는 직무 (e.g. Front-end Engineer)"
        jobTrack:
          type: string
          description: "직무 트랙 (e.g. 기술/개발 트랙)"
        minEducationLevel:
          type: string
          enum: [HIGH_SCHOOL, ASSOCIATE, BACHELOR, MASTER, DOCTORATE]
          description: 필수 학력 요건
        militaryPolicy:
          type: string
          enum: [NOT_RELEVANT, REQUIRED, BONUS, NOT_REFLECTED]
          description: "병역 여부 (무관/필수/가산점 부여/미반영)"
        careerPolicy:
          type: string
          enum: [NOT_RELEVANT, REQUIRED, BONUS, NOT_REFLECTED]
          description: "직무 관련 경력 (무관/필수/가산점 부여/미반영)"
        deadline:
          type: string
          format: date
          description: "마감일 (YYYY-MM-DD, 미입력 시 상시채용)"
        preferredCondition:
          type: string
          description: "우대조건 (e.g. 경력 3년 이상)"
        salaryRange:
          type: string
          enum: [UNDER_2400, RANGE_2400_3000, RANGE_3000_3600, RANGE_3600_4200, RANGE_4200_5000, OVER_5000]
          description: 급여 조건 (범위 선택)
        salaryDescription:
          type: string
          description: "급여 조건 텍스트 (e.g. 면접 후 결정 (회사 내규에 따름))"
        location:
          type: string
          description: "근무지 (e.g. 서울 강남구)"
        workStart:
          type: string
          description: "출근 시간 (HH:mm, e.g. 09:00)"
        workEnd:
          type: string
          description: "퇴근 시간 (HH:mm, e.g. 18:00)"
        applicationUrl:
          type: string
          format: uri
          description: "지원 링크 바로가기 URL"
        aiEvalCredential:
          type: boolean
          default: false
          description: "AI 정량 평가 — 자격증/어학 (정량 점수화)"
        aiEvalExperience:
          type: boolean
          default: false
          description: "AI 정량 평가 — 대외/해외경험 (경험 가점)"
        aiEvalAward:
          type: boolean
          default: false
          description: "AI 정량 평가 — 수상 내역 (직무 연관성)"
        skills:
          type: array
          items: { type: string }
          description: 요구 기술 스택
      example:
        title: "시니어 백엔드 개발자 (Python/Django)"
        jobTrack: "기술/개발 트랙"
        minEducationLevel: "HIGH_SCHOOL"
        militaryPolicy: "NOT_RELEVANT"
        careerPolicy: "NOT_RELEVANT"
        deadline: "2026-02-28"
        preferredCondition: "경력 3년 이상, AWS 클라우드 숙련자"
        salaryRange: "UNDER_2400"
        salaryDescription: "면접 후 결정 (회사 내규에 따름)"
        location: "서울특별시 강남구 테헤란로"
        workStart: "09:00"
        workEnd: "18:00"
        applicationUrl: "https://careers.company.com/jobs/123"
        aiEvalCredential: false
        aiEvalExperience: false
        aiEvalAward: false
        skills: ["Python", "Django", "AWS", "PostgreSQL"]

    UpdateJobPosting:
      type: object
      description: 공고 수정 요청 (모든 필드 선택, 최소 1개 이상 필요)
      properties:
        title:
          type: string
          description: "뽑는 직무"
        jobTrack:
          type: string
          description: "직무 트랙"
        status:
          type: string
          enum: [OPEN, CLOSED]
          description: "채용 상태"
        minEducationLevel:
          type: string
          enum: [HIGH_SCHOOL, ASSOCIATE, BACHELOR, MASTER, DOCTORATE]
        militaryPolicy:
          type: string
          enum: [NOT_RELEVANT, REQUIRED, BONUS, NOT_REFLECTED]
        careerPolicy:
          type: string
          enum: [NOT_RELEVANT, REQUIRED, BONUS, NOT_REFLECTED]
        deadline:
          type: string
          format: date
          nullable: true
          description: "마감일 (YYYY-MM-DD, null로 상시채용 전환 가능)"
        preferredCondition:
          type: string
          nullable: true
        salaryRange:
          type: string
          enum: [UNDER_2400, RANGE_2400_3000, RANGE_3000_3600, RANGE_3600_4200, RANGE_4200_5000, OVER_5000]
          nullable: true
        salaryDescription:
          type: string
          nullable: true
        location:
          type: string
          nullable: true
        workStart:
          type: string
          nullable: true
          description: "HH:mm"
        workEnd:
          type: string
          nullable: true
          description: "HH:mm"
        applicationUrl:
          type: string
          format: uri
          nullable: true
        aiEvalCredential: { type: boolean }
        aiEvalExperience: { type: boolean }
        aiEvalAward: { type: boolean }
        skills:
          type: array
          items: { type: string }
          description: "요구 기술 스택 (전체 교체)"
      example:
        title: "시니어 프론트엔드 개발자"
        status: "CLOSED"
        deadline: null
        skills: ["React", "TypeScript"]

    # ── 기업 전용 응답 스키마 ──

    CorporationJobPostingItem:
      type: object
      description: |
        기업 전용 자사 공고 목록 아이템.
        프론트엔드에서 jobTrack 값으로 직무 아이콘을 매핑할 수 있습니다.
      properties:
        id: { type: string }
        title:
          type: string
          description: "직무 이름 (e.g. 시니어 백엔드 엔지니어)"
        jobTrack:
          type: string
          description: "직무 트랙 — 프론트에서 직무 로고 아이콘 매핑 키로 사용"
        status: { type: string, enum: [OPEN, CLOSED] }
        deadline:
          type: string
          format: date-time
          nullable: true
          description: "마감일 (null이면 상시채용)"
        daysLeft:
          type: integer
          nullable: true
          description: "마감까지 남은 일수 (null=상시채용, 0=오늘마감, 음수=이미 경과)"
        location:
          type: string
          nullable: true
          description: "근무지 주소"
        createdAt: { type: string, format: date-time }
        updatedAt: { type: string, format: date-time }
      example:
        id: "clx1abc..."
        title: "시니어 백엔드 엔지니어 (Java/Spring)"
        jobTrack: "기술/개발 트랙"
        status: "OPEN"
        deadline: "2026-02-21T00:00:00.000Z"
        daysLeft: 14
        location: "서울 강남구"
        createdAt: "2026-01-15T09:00:00.000Z"
        updatedAt: "2026-01-15T09:00:00.000Z"

    # ── 취준생용 응답 스키마 ──

    JobPostingListItem:
      type: object
      properties:
        id: { type: string }
        title: { type: string }
        status: { type: string, enum: [OPEN, CLOSED] }
        deadline: { type: string, format: date-time, nullable: true }
        preferredCondition: { type: string, nullable: true }
        salaryRange:
          type: string
          enum: [UNDER_2400, RANGE_2400_3000, RANGE_3000_3600, RANGE_3600_4200, RANGE_4200_5000, OVER_5000]
          nullable: true
        salaryDescription: { type: string, nullable: true, description: "급여 조건 텍스트" }
        location: { type: string, nullable: true }
        workStart: { type: string, nullable: true }
        workEnd: { type: string, nullable: true }
        matchRate:
          type: integer
          nullable: true
          description: "매칭률 (인증된 취준생인 경우, 0~100)"
        createdAt: { type: string, format: date-time }
        corporation:
          type: object
          properties:
            id: { type: string }
            name: { type: string }
            description: { type: string, nullable: true }
            thumbnailUrl: { type: string, nullable: true }
            tags:
              type: array
              items: { type: string }
              description: "기업 태그 (e.g. 핀테크, 유니콘, 시리즈D)"

    JobPostingDetail:
      type: object
      properties:
        id: { type: string }
        title: { type: string }
        jobTrack: { type: string }
        status: { type: string, enum: [OPEN, CLOSED] }
        minEducationLevel:
          type: string
          enum: [HIGH_SCHOOL, ASSOCIATE, BACHELOR, MASTER, DOCTORATE]
        militaryPolicy:
          type: string
          enum: [NOT_RELEVANT, REQUIRED, BONUS, NOT_REFLECTED]
        careerPolicy:
          type: string
          enum: [NOT_RELEVANT, REQUIRED, BONUS, NOT_REFLECTED]
        deadline: { type: string, format: date-time, nullable: true }
        preferredCondition: { type: string, nullable: true }
        salaryRange:
          type: string
          enum: [UNDER_2400, RANGE_2400_3000, RANGE_3000_3600, RANGE_3600_4200, RANGE_4200_5000, OVER_5000]
          nullable: true
        salaryDescription: { type: string, nullable: true, description: "급여 조건 텍스트" }
        location: { type: string, nullable: true }
        workStart: { type: string, nullable: true }
        workEnd: { type: string, nullable: true }
        applicationUrl: { type: string, nullable: true }
        aiEvalCredential: { type: boolean }
        aiEvalExperience: { type: boolean }
        aiEvalAward: { type: boolean }
        skills:
          type: array
          items: { type: string }
        matchRate:
          type: integer
          nullable: true
          description: "매칭률 (인증된 취준생인 경우)"
        createdAt: { type: string, format: date-time }
        updatedAt: { type: string, format: date-time }
        corporation:
          type: object
          properties:
            id: { type: string }
            name: { type: string }
            description: { type: string, nullable: true }
            thumbnailUrl: { type: string, nullable: true }
            industry: { type: string }
            address: { type: string }
            companySize:
              type: string
              enum: [STARTUP, SMALL, MEDIUM, LARGE, ENTERPRISE]
            homepageUrl: { type: string, nullable: true }
            tags:
              type: array
              items: { type: string }

    # ── 브랜딩 카드 스키마 ──

    BrandingCardGenerated:
      type: object
      description: AI 생성 직후 반환되는 브랜딩 카드 데이터
      properties:
        id: { type: string }
        catchphrase:
          type: string
          description: "메인 슬로건 (40자 이내)"
        description:
          type: string
          description: "기업 한 줄 소개 (100자 이내)"
        keywords:
          type: array
          items: { type: string }
          description: "핵심 키워드 해시태그 (3~5개)"
        backgroundStyle:
          type: string
          enum: [navy, green, purple, black]
          description: "AI 추천 배경 스타일"
        brandingTip:
          type: string
          nullable: true
          description: "AI 브랜딩 개선 팁"
        status:
          type: string
          enum: [DRAFT, PUBLISHED]
      example:
        id: "clx1abc..."
        catchphrase: "기술로 세상을 더 심플하게 만드는 사람들"
        description: "자유로운 소통과 성장이 공존하는 테크웨이브에서 당신의 커리어 파도를 만들어보세요."
        keywords: ["자율출퇴근", "무제한식대", "성장지원금"]
        backgroundStyle: "navy"
        brandingTip: "핵심 가치를 '동사'형으로 표현하면 훨씬 역동적인 인상을 줍니다."
        status: "DRAFT"

    BrandingCardDetail:
      type: object
      description: 브랜딩 카드 전체 상세 정보
      properties:
        id: { type: string }
        catchphrase: { type: string }
        description: { type: string }
        keywords:
          type: array
          items: { type: string }
        backgroundStyle: { type: string }
        backgroundUrl: { type: string, nullable: true }
        thumbnailUrl: { type: string, nullable: true }
        thumbnailSource:
          type: string
          enum: [file, ai]
        status:
          type: string
          enum: [DRAFT, PUBLISHED]
        prompt: { type: string, nullable: true }
        createdAt: { type: string, format: date-time }
        updatedAt: { type: string, format: date-time }

    UpdateBrandingCard:
      type: object
      description: "브랜딩 카드 수정 요청 (모든 필드 선택)"
      properties:
        catchphrase:
          type: string
          description: "메인 슬로건 (40자 이내)"
        description:
          type: string
          description: "기업 한 줄 소개 (100자 이내)"
        keywords:
          type: array
          items: { type: string }
          description: "핵심 키워드 (전체 교체)"
        backgroundStyle:
          type: string
          enum: [navy, green, purple, black, custom]
        backgroundUrl:
          type: string
          nullable: true
          description: "커스텀 배경 이미지 URL"
        thumbnailUrl:
          type: string
          nullable: true
          description: "썸네일 이미지 URL"
        thumbnailSource:
          type: string
          enum: [file, ai]
        status:
          type: string
          enum: [DRAFT, PUBLISHED]
          description: "PUBLISHED로 변경 시 취준생에게 공개"
      example:
        catchphrase: "기술로 세상을 더 심플하게 만드는 사람들"
        keywords: ["자율출퇴근", "무제한식대", "성장지원금"]
        status: "PUBLISHED"

    Pagination:
      type: object
      properties:
        page: { type: integer }
        limit: { type: integer }
        total: { type: integer }
        totalPages: { type: integer }

  responses:
    Unauthorized:
      description: 로그인 필요
      content:
        application/json:
          schema: { $ref: "#/components/schemas/Error" }
          example:
            error: { code: UNAUTHORIZED, message: "로그인이 필요합니다." }
    UserNotFound:
      description: 사용자 없음
      content:
        application/json:
          schema: { $ref: "#/components/schemas/Error" }
    ValidationError:
      description: 입력값 오류
      content:
        application/json:
          schema: { $ref: "#/components/schemas/Error" }
          example:
            error: { code: VALIDATION_ERROR, message: "입력값이 올바르지 않습니다." }
    DBError:
      description: DB 오류
      content:
        application/json:
          schema: { $ref: "#/components/schemas/Error" }
          example:
            error: { code: DB_ERROR, message: "데이터베이스 오류가 발생했습니다." }
